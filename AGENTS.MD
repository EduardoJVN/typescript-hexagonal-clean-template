# ü§ñ AI Agents & Automation Logic

Este documento describe c√≥mo integrar Agentes de IA y servicios de automatizaci√≥n dentro de la Arquitectura Hexagonal de este template.

---

## üèóÔ∏è Ubicaci√≥n en la Arquitectura

Para mantener el desacoplamiento, los agentes se distribuyen siguiendo la regla de dependencia:

### 1. Capa de Dominio (`src/domain/ai`)
Aqu√≠ definimos **qu√©** puede hacer el agente, sin importar qu√© modelo (OpenAI, Claude, Local LLM) se use.
- **Ports:** Interfaces como `IAgentProvider`, `IPromptRepository`.
- **Entities:** Definici√≥n de `AgentResponse`, `ConversationContext`.

### 2. Capa de Aplicaci√≥n (`src/application/ai`)
Aqu√≠ reside la **orquestaci√≥n** del agente.
- **Use Cases:** `ProcessNaturalLanguageCommand`, `GenerateReportWithAI`.
- Los casos de uso reciben los *Ports* e interact√∫an con los modelos de negocio.

### 3. Capa de Infraestructura (`src/infrastructure/adapters/ai`)
Aqu√≠ implementamos la tecnolog√≠a espec√≠fica.
- **Adapters:** `OpenAIAgentAdapter`, `LangChainWrapper`.
- Es la √∫nica capa que conoce las API Keys y los SDKs de terceros.

---

## üõ†Ô∏è Flujo de Trabajo de un Agente



1. **Input:** Un `entry-point` (ej. una ruta de Express) recibe un prompt.
2. **Orquestaci√≥n:** El Caso de Uso de la capa de **Application** solicita al **Domain** las reglas de validaci√≥n.
3. **Ejecuci√≥n:** Se llama al adaptador en **Infrastructure** para comunicarse con el modelo de IA.
4. **Logging:** Todo el proceso se traza utilizando el `ILogger` inyectado.

---

## üìã Est√°ndares para Agentes

| Requisito | Descripci√≥n |
| :--- | :--- |
| **Stateless** | Los agentes deben ser sin estado siempre que sea posible; el contexto se pasa en el DTO. |
| **Timeout Guard** | Todo llamado a un agente externo debe incluir un l√≠mite de tiempo en infraestructura. |
| **Mocking** | Debido al costo y latencia, todos los agentes deben tener un `MockAgentAdapter` para tests. |
| **Observabilidad** | Los prompts y respuestas deben loguearse (anonimizados) para auditor√≠a. |

---

## üöÄ Ejemplo de Inyecci√≥n

```typescript
// En Application
constructor(
  private readonly agent: IAgentProvider,
  private readonly logger: ILogger
) {}

async execute(input: string) {
  this.logger.info("Agente iniciando proceso...");
  return await this.agent.complete(input);
}
```